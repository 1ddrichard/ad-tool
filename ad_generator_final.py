import streamlit as st
import pandas as pd
import io
import zipfile
from datetime import datetime
import xlwt

# =========================================================================
# 1. æ¨¡æ¿æ•°æ®å®šä¹‰ (å·²æ ¹æ®ä½ æä¾›çš„ CSV å®Œæ•´è½¬æ¢)
# =========================================================================

# è¾…åŠ©å‡½æ•°ï¼šå¤„ç†æ•°å€¼æ ¼å¼ï¼Œå»é™¤ .0
def clean_val(val):
    if pd.isna(val) or val == "":
        return ""
    s_val = str(val)
    if s_val.endswith(".0"):
        return s_val[:-2]
    return val

# å®šä¹‰ä¸‰ä¸ªæ¸ é“çš„å®Œæ•´æ¨¡æ¿æ•°æ®
# è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼šä¿ç•™åŸæœ‰çš„æ‰€æœ‰åˆ—å’Œè¡Œï¼ŒåªæŠŠ ID å’Œ åç§° å˜æˆå ä½ç¬¦
RAW_DATA = {
    "ç©¿å±±ç”²": {
        "sample_name": "æŠ¢çº¢åŒ…æé€Ÿæé†’",
        "sample_pid": "42911",
        "sample_adid": "5757921",
        "columns": ["åº”ç”¨","å­æ¸ é“","sdkå¹¿å‘Šæºæ ·å¼","å¹¿å‘Šä½¿ç”¨ç±»å‹","å¹¿å‘Šæ‹“å±•å","å¤‡æ³¨","ä»£ç ä½åç§°","ç«ä»·ç±»å‹(æ ‡å‡†;æœåŠ¡ç«¯ç«ä»·;å®¢æˆ·ç«¯ç«ä»·)","æ˜¯å¦ä½¿â½¤Mèšåˆ","cpmè®¾ç½®","å¹¿å‘Šå¹³å°","tappid","å¹¿å‘Šç±»å‹","æ¸²æŸ“â½…å¼","â¼´å‘Šæ ·å¼","æ¨¡ç‰ˆæ ·å¼","ç´ æç±»å‹","æ˜¯å¦è½®æ’­","å¹¿å‘Šå°ºå¯¸","ç‚¹ç›æ ·å¼","è§†é¢‘æ’­æ”¾â½…å‘","å¥–åŠ±åç§°","å¥–åŠ±æ•°é‡","å›è°ƒè®¾ç½®","å›è°ƒurl","â¼´å‘Šé“ºå¼€â¼¤â¼©","è·³è¿‡","endcard","å¹¿å‘Šç­–ç•¥"],
        # ç”±äºæ•°æ®è¡Œæ•°è¿‡å¤šï¼Œè¿™é‡Œä½¿ç”¨ç®€åŒ–çš„åŠ è½½é€»è¾‘ï¼Œå®é™…è¿è¡Œæ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆå‡ åè¡Œ
        # ä¸‹é¢æ˜¯ç²¾ç®€åçš„ç»“æ„é€»è¾‘ï¼Œç¨‹åºè¿è¡Œæ—¶ä¼šæ ¹æ®è¿™ä¸ªé€»è¾‘å±•å¼€
        "rows": [] 
    },
    "ä¼˜é‡æ±‡": {
        "sample_name": "æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶",
        "sample_pid": "41965",
        "sample_adid": "1211717706",
        "columns": ["äº§å“","å­æ¸ é“","sdkå¹¿å‘Šæºæ ·å¼","å¹¿å‘Šä½¿ç”¨ç±»å‹","å¹¿å‘Šæ‹“å±•å","å¤‡æ³¨","ä»£ç ä½åç§°","ä»·æ ¼ç­–ç•¥","å®æ—¶ç«ä»·ç±»å‹(æœåŠ¡ç«¯ç«ä»·/å®¢æˆ·ç«¯ç«ä»·)","cpmè®¾ç½®","å¹¿å‘Šå¹³å°","tappid","å¹¿å‘Šç±»å‹","æ¸²æŸ“æ–¹å¼","æ¥å…¥æ–¹å¼","è‡ªæ¸²æŸ“å¹¿å‘Šæ ·å¼","æ¨¡ç‰ˆæ ·å¼","ç´ æç±»å‹","å¼€å±å¹¿å‘Šæ ·å¼","å›è°ƒè®¾ç½®","æ¿€åŠ±åœºæ™¯","æ¿€åŠ±æ ·å¼","å›è°ƒurl","æ ¡éªŒå¯†é’¥","å¹¿å‘Šç­–ç•¥"],
        "rows": []
    },
    "å¿«æ‰‹": {
        "sample_name": "å°é£æ°”è±¡ç«™",
        "sample_pid": "41701",
        "sample_adid": "2668400013",
        "columns": ["åº”ç”¨","å­æ¸ é“","sdkå¹¿å‘Šæºæ ·å¼","å¹¿å‘Šä½¿ç”¨ç±»å‹","å¹¿å‘Šæ‹“å±•å","å¤‡æ³¨","ä»£ç ä½åç§°","cpmè®¾ç½®","å¹¿å‘Šå¹³å°","tappid","å¹¿å‘Šç±»å‹","æ¸²æŸ“æ–¹å¼","ç´ æç±»å‹","æ¸²æŸ“æ¨¡ç‰ˆID","è§†é¢‘æ’­æ”¾â½…å‘","å¥–åŠ±åç§°","å¥–åŠ±æ•°é‡","å›è°ƒè®¾ç½®","å›è°ƒurl","è·³è¿‡æŒ‰é’®","å€’è®¡æ—¶","æ’­æ”¾å£°éŸ³","å¹¿å‘Šç­–ç•¥","ä»·æ ¼ç­–ç•¥(1-ç›®æ ‡ä»·,2-å®æ—¶ç«ä»·)","ç«ä»·ç±»å‹(1-å®¢æˆ·ç«¯ç«ä»·,2-æœåŠ¡ç«¯ç«ä»·)"],
        "rows": []
    }
}

# --- æ•°æ®è£…è½½ (å°†ä½ æä¾›çš„ CSV æ–‡æœ¬ç¡¬ç¼–ç ä¸º Python æ•°æ®) ---
# ä¸ºäº†ä¿æŒä»£ç æ•´æ´ä¸”å¯è¿è¡Œï¼Œè¿™é‡Œæˆ‘å°†ä½ æä¾›çš„ CSV å†…å®¹ç›´æ¥è½¬æ¢ä¸ºäº† List[Dict] ç»“æ„

# 1. ç©¿å±±ç”²æ•°æ®è£…è½½ (å·²ä¿®å¤å¼•å·é—®é¢˜)
csj_csv = """
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads1000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-1000,æ ‡å‡†,å¦,1000.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads800,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-800,æ ‡å‡†,å¦,800.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads600,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-600,æ ‡å‡†,å¦,600.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads400,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-400,æ ‡å‡†,å¦,400.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-150,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads75,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-75,æ ‡å‡†,å¦,75.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-ad25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-adbase,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbidv50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-adbidding50v,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbidv,,æŠ¢çº¢åŒ…æé€Ÿæé†’-plaquevideo-adbiddingv,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,3.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew2000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-2000,æ ‡å‡†,å¦,2000.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew1500,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-1500,æ ‡å‡†,å¦,1500.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew1000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-1000,æ ‡å‡†,å¦,1000.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew800,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-800,æ ‡å‡†,å¦,800.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew600,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-600,æ ‡å‡†,å¦,600.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew400,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-400,æ ‡å‡†,å¦,400.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-150,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew75,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-75,æ ‡å‡†,å¦,75.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnew25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-ad25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnewbase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-adbase,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnewbid100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-adbidding100,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnewbid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,è§†é¢‘,è§†é¢‘-video,adsnewbid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-rwvideo-new-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ¿€åŠ±è§†é¢‘,æ¨¡æ¿æ¸²æŸ“,,,,,,,1.0,è™šæ‹Ÿé‡‘å¸,1.0,0.0,,,,,video_waterfall_bid_new_hb
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp500,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-500,æ ‡å‡†,å¦,500.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp350,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-350,æ ‡å‡†,å¦,350.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-100,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbp25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbpbase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-base,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbpbid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbpbid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-åŠå±æ’å±-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,2.0,1.0,plaque_waterfall_bid_new_hb2
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads500,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad500,æ ‡å‡†,å¦,500.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads350,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad350,æ ‡å‡†,å¦,350.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad150,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,ads25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-ad25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,adsbase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-adbase,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,adsbid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,2.0,,,plaque_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,adsbid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msgæ’å±-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3,4]",,3.0,,,,,,,,,2.0,,,plaque_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew2000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-2000,æ ‡å‡†,å¦,2000.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew1500,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-1500,æ ‡å‡†,å¦,1500.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew1000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-1000,æ ‡å‡†,å¦,1000.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew800,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-800,æ ‡å‡†,å¦,800.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew600,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-600,æ ‡å‡†,å¦,600.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew400,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-400,æ ‡å‡†,å¦,400.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-150,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew75,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-75,æ ‡å‡†,å¦,75.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnew25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-ad25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnewbase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-adbase,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnewbid100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-adbidding100,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnewbid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsnewbid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-new-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq2000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-2000,æ ‡å‡†,å¦,2000.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq1500,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-1500,æ ‡å‡†,å¦,1500.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq1000,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-1000,æ ‡å‡†,å¦,1000.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq800,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-800,æ ‡å‡†,å¦,800.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq600,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-600,æ ‡å‡†,å¦,600.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq400,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-400,æ ‡å‡†,å¦,400.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-150,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq75,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-75,æ ‡å‡†,å¦,75.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaq25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaqbid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,å¼€å±,å¼€å±-splash,adsplaqbid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-splash-plaq-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,å¼€å±,éåŸç”Ÿ,,,,,,1.0,1.0,,,,,,,,splash_waterfall_bid_new_hb
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,adsmsg100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msg-ad100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3]",,3.0,,,,,,,,,,,,msg_waterfall_ecpm_yes
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,adsmsg50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msg-ad50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3]",,3.0,,,,,,,,,,,,msg_waterfall_ecpm_yes
41965.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,adsmsg25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msg-ad25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3]",,3.0,,,,,,,,,,,,msg_waterfall_ecpm_yes
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,adsmsgbase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msg-adbase,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3]",,3.0,,,,,,,,,,,,msg_waterfall_ecpm_yes
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,adsmsgbid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msg-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3]",,3.0,,,,,,,,,2.0,,,msg_waterfall_ecpm_yes
42911.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,adsmsgbid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-msg-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,3]",,3.0,,,,,,,,,2.0,,,msg_waterfall_ecpm_yes
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly500,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-500,æ ‡å‡†,å¦,500.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly350,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-350,æ ‡å‡†,å¦,350.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly200,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-200,æ ‡å‡†,å¦,200.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly150,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-150,æ ‡å‡†,å¦,150.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly100,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-100,æ ‡å‡†,å¦,100.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-50,æ ‡å‡†,å¦,50.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponly25,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-25,æ ‡å‡†,å¦,25.0,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponlybase,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-base,æ ‡å‡†,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponlybid,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-adbidding,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
42911.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbponlybid50,,æŠ¢çº¢åŒ…æé€Ÿæé†’-halfplaque-adbidding50,å®¢æˆ·ç«¯ç«ä»·,å¦,,ç©¿å±±ç”²,5757921.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,,,3.0,,,,1.0,,,,,2.0,1.0,1.0,plaque_waterfall_halfplaque_only
"""
df_csj = pd.read_csv(io.StringIO(csj_csv), header=None, names=RAW_DATA["ç©¿å±±ç”²"]["columns"])
RAW_DATA["ç©¿å±±ç”²"]["rows"] = df_csj.to_dict(orient="records")

# 2. ä¼˜é‡æ±‡æ•°æ®è£…è½½
ylh_csv = """
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbid,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-bid,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbid50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-bid50,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp500,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-500,ç›®æ ‡ä»·,,500.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp350,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-350,ç›®æ ‡ä»·,,350.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp200,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-200,ç›®æ ‡ä»·,,200.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp150,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-150,ç›®æ ‡ä»·,,150.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp100,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-100,ç›®æ ‡ä»·,,100.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-50,ç›®æ ‡ä»·,,50.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbp25,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-25,ç›®æ ‡ä»·,,25.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbpbase,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaque-base,é»˜è®¤åº•ä»·,,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,adsbid,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-bid,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,adsbid50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-bid50,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads1000,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-1000,ç›®æ ‡ä»·,,1000.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads800,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-800,ç›®æ ‡ä»·,,800.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads600,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-600,ç›®æ ‡ä»·,,600.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads400,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-400,ç›®æ ‡ä»·,,400.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads200,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-200,ç›®æ ‡ä»·,,200.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads150,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-150,ç›®æ ‡ä»·,,150.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads100,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-100,ç›®æ ‡ä»·,,100.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads75,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-75,ç›®æ ‡ä»·,,75.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-50,ç›®æ ‡ä»·,,50.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,ads25,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-25,ç›®æ ‡ä»·,,25.0,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,è§†é¢‘,è§†é¢‘-video,adsbase,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-video-base,é»˜è®¤åº•ä»·,,,ä¼˜é‡æ±‡,1211717706.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,SDK,,,,,NotNeedServerVerify,TASK_REWARD,ALL_DIRECTION,,,video_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbid,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-bid,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbid50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-bid50,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads600neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-600neww,ç›®æ ‡ä»·,,600.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads400neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-400neww,ç›®æ ‡ä»·,,400.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads200neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-200neww,ç›®æ ‡ä»·,,200.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads150neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-150neww,ç›®æ ‡ä»·,,150.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads100neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-100neww,ç›®æ ‡ä»·,,100.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads75neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-75neww,ç›®æ ‡ä»·,,75.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads50neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-50neww,ç›®æ ‡ä»·,,50.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,ads25neww,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-25neww,ç›®æ ‡ä»·,,25.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,adsbase,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-plaquevideo-base,é»˜è®¤åº•ä»·,,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_FULL""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_bid_new_gongjuhb
41965.0,csj,å¼€å±,å¼€å±-splash,adsbid,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-adbid,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,adsbid50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-adbid50,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads1000new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-1000new2w,ç›®æ ‡ä»·,,1000.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads800new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-800new2w,ç›®æ ‡ä»·,,800.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads600new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-600new2w,ç›®æ ‡ä»·,,600.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads400new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-400new2w,ç›®æ ‡ä»·,,400.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads200new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-200new2w,ç›®æ ‡ä»·,,200.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads150new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-150new2w,ç›®æ ‡ä»·,,150.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads100new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-100new2w,ç›®æ ‡ä»·,,100.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads75new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-75new2w,ç›®æ ‡ä»·,,75.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads50new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-50new2w,ç›®æ ‡ä»·,,50.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,ads25new2,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-25new2w,ç›®æ ‡ä»·,,25.0,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,å¼€å±,å¼€å±-splash,adsbase,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-splash-new2-base,é»˜è®¤åº•ä»·,,,ä¼˜é‡æ±‡,1211717706.0,å¼€å±,,SDK,,,"[""FLASH_IMAGE_V"",""FLASH_VIDEO_V""]",FLASH,,,,,,splash_waterfall_c
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponlybid,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-bid,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponlybid50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-bid50,å®æ—¶ç«ä»·,å®¢æˆ·ç«¯ç«ä»·,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly500,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-500,ç›®æ ‡ä»·,,500.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly350,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-350,ç›®æ ‡ä»·,,350.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly200,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-200,ç›®æ ‡ä»·,,200.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly150,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-150,ç›®æ ‡ä»·,,150.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly100,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-100,ç›®æ ‡ä»·,,100.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly50,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-50,ç›®æ ‡ä»·,,50.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponly25,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-25,ç›®æ ‡ä»·,,25.0,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
41965.0,csj,æ™®é€šæ’å±/æ¨¡æ¿,æ’å±-plaque,adsbponlybase,,æ™ºèƒ½æ—¥ç¨‹ç®¡å®¶-halfplaque-base,é»˜è®¤åº•ä»·,,,ä¼˜é‡æ±‡,1211717706.0,æ’å±,æ¨¡æ¿æ¸²æŸ“,SDK,"16_9_image,16_9_video","[""INLINE_V""]","[""VIDEO"",""IMAGE""]",,,,,,,plaque_waterfall_halfplaque_only2
"""
df_ylh = pd.read_csv(io.StringIO(ylh_csv), header=None, names=RAW_DATA["ä¼˜é‡æ±‡"]["columns"])
RAW_DATA["ä¼˜é‡æ±‡"]["rows"] = df_ylh.to_dict(orient="records")

# 3. å¿«æ‰‹æ•°æ®è£…è½½
ks_csv = """
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,400ks,,å°é£æ°”è±¡ç«™-æ–°æ’å±-400-ks1,400.0,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,300ks,,å°é£æ°”è±¡ç«™-æ–°æ’å±-300-ks1,300.0,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,200ks,,å°é£æ°”è±¡ç«™æ‰‹-æ–°æ’å±-200-ks1,200.0,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,150ks,,å°é£æ°”è±¡ç«™æ‰‹-æ–°æ’å±-150-ks1,150.0,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,100ks,,å°é£æ°”è±¡ç«™-æ–°æ’å±-100-ks1,100.0,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,60ks,,å°é£æ°”è±¡ç«™-æ–°æ’å±-60-ks1,60.0,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,æ’å±è§†é¢‘,æ’å±-plaque,biddingks,,å°é£æ°”è±¡ç«™-æ–°æ’å±-bidding-ks1,,å¿«æ‰‹,2668400013.0,æ–°æ’å±,æ¨¡æ¿æ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_bid_new_gongjuhb,2.0,1.0
41701.0,csj,è§†é¢‘,è§†é¢‘-video,400ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-400-ks1,400.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,300ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-300-ks1,300.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,250ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-250-ks1,250.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,200ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-200-ks1,200.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,150ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-150-ks1,150.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,100ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-100-ks1,100.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,60ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-60-ks1,60.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,30ksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-30-ks1,30.0,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,1.0,
41701.0,csj,è§†é¢‘,è§†é¢‘-video,biddingksnew,,å°é£æ°”è±¡ç«™-æ¿€åŠ±è§†é¢‘-bidding-ks1,,å¿«æ‰‹,2668400013.0,æ¿€åŠ±è§†é¢‘,è‡ªæ¸²æŸ“,,,"[1]",1.0,1.0,0.0,,,,,video_waterfall_bid_new_gongjuhb,2.0,1.0
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,150ksnew,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµæ’å±-150-ks1,150.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_ecpm_no,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,100ksnew,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµæ’å±-100-ks1,100.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_ecpm_no,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,70ksnew,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµæ’å±-70-ks1,70.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_ecpm_no,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,45ksnew,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµæ’å±-45-ks1,45.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_ecpm_no,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,30ksnew,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµæ’å±-30-ks1,30.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_ecpm_no,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,æ’å±-plaque,biddingksnew,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµæ’å±-bidding-ks1,,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,plaque_waterfall_ecpm_no,2.0,1.0
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,msg150ks,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµ-150-ks1,150.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,msg_waterfall_ecpm_yes,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,msg100ks,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµ-100-ks1,100.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,msg_waterfall_ecpm_yes,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,msg70ks,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµ-70-ks1,70.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,msg_waterfall_ecpm_yes,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,msg45ks,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµ-45-ks1,45.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,msg_waterfall_ecpm_yes,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,msg30ks,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµ-30-ks1,30.0,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,msg_waterfall_ecpm_yes,1.0,
41701.0,csj,ä¿¡æ¯æµè‡ªæ¸²æŸ“,ä¿¡æ¯æµ-msg,msgbiddingks,,å°é£æ°”è±¡ç«™-ä¿¡æ¯æµ-bidding-ks1,,å¿«æ‰‹,2668400013.0,ä¿¡æ¯æµ,è‡ªæ¸²æŸ“,"[1,2,5,6]",,,,,,,,,,msg_waterfall_ecpm_yes,2.0,1.0
"""
df_ks = pd.read_csv(io.StringIO(ks_csv), header=None, names=RAW_DATA["å¿«æ‰‹"]["columns"])
RAW_DATA["å¿«æ‰‹"]["rows"] = df_ks.to_dict(orient="records")

# =========================================================================
# 2. æ ¸å¿ƒå¤„ç†å‡½æ•°ï¼šæ›¿æ¢é€»è¾‘
# =========================================================================
def process_rows(channel, p_name, p_id, t_id):
    """
    æ ¹æ®ç”¨æˆ·è¾“å…¥ï¼Œæ·±åº¦å¤åˆ¶æ¨¡æ¿è¡Œå¹¶æ›¿æ¢å…³é”®å­—æ®µ
    """
    template_conf = RAW_DATA.get(channel)
    if not template_conf:
        return pd.DataFrame()

    rows = template_conf["rows"]
    sample_name = template_conf["sample_name"]
    sample_pid = template_conf["sample_pid"]
    sample_adid = template_conf["sample_adid"]
    
    columns = template_conf["columns"]
    
    new_rows = []
    for r in rows:
        new_row = r.copy()
        
        # éå†è¯¥è¡Œçš„æ‰€æœ‰åˆ—è¿›è¡Œæ›¿æ¢
        for k, v in new_row.items():
            # æ•°æ®æ¸…æ´—ï¼šæŠŠ 41846.0 è¿™ç§å˜æˆ "41846"
            val_str = clean_val(v)
            
            # æ›¿æ¢é€»è¾‘
            # 1. æ›¿æ¢äº§å“ID (ä¾‹å¦‚ 42911 -> æ–°çš„ p_id)
            # æ³¨æ„ï¼šæ¨¡æ¿é‡Œæ˜¯ 42911.0ï¼Œclean_val åæ˜¯ 42911ï¼Œæ‰€ä»¥è¿™é‡Œåˆ¤æ–­åŒ…å«å…³ç³»
            if sample_pid in val_str:
                val_str = val_str.replace(sample_pid, str(p_id))
            
            # 2. æ›¿æ¢å¹¿å‘ŠID (ä¾‹å¦‚ 5757921 -> æ–°çš„ t_id)
            if sample_adid in val_str:
                val_str = val_str.replace(sample_adid, str(t_id))
            
            # 3. æ›¿æ¢äº§å“åç§° (ä¾‹å¦‚ "æŠ¢çº¢åŒ…æé€Ÿæé†’-plaque" -> "æ–°äº§å“å-plaque")
            # å¿…é¡»å¤„ç†å¥½åç¼€ï¼Œåªæ›¿æ¢åç§°éƒ¨åˆ†
            if sample_name in val_str:
                val_str = val_str.replace(sample_name, p_name)
                
            new_row[k] = val_str
            
        new_rows.append(new_row)
        
    return pd.DataFrame(new_rows, columns=columns)

def create_xls_file(df):
    output = io.BytesIO()
    workbook = xlwt.Workbook(encoding='utf-8')
    worksheet = workbook.add_sheet('Sheet1')
    
    # å†™å…¥è¡¨å¤´
    for col_idx, header in enumerate(df.columns):
        worksheet.write(0, col_idx, header)
    
    # å†™å…¥æ•°æ®è¡Œ
    for row_idx, row_data in df.iterrows():
        for col_idx, value in enumerate(row_data):
            # å°è¯•è½¬å›æ•°å­—ï¼Œå¦‚æœçœ‹èµ·æ¥åƒæ•°å­—ï¼ˆä¸ºäº†Excelé‡Œé¢æ˜¯æ•°å€¼ç±»å‹ï¼‰
            val = value
            try:
                if isinstance(val, str) and val.replace('.','',1).isdigit():
                    # è¿™é‡Œä¿ç•™ ID ä¸ºå­—ç¬¦ä¸²ï¼ŒCPM ä¸ºæ•°å­—
                    # ç®€å•è§„åˆ™ï¼šå¦‚æœå€¼ç­‰äº p_id æˆ– t_idï¼Œä¿æŒå­—ç¬¦ä¸²ï¼›å¦åˆ™è½¬æ•°å­—
                    pass 
            except:
                pass
            worksheet.write(row_idx + 1, col_idx, val)
            
    workbook.save(output)
    output.seek(0)
    return output

# =========================================================================
# 3. Streamlit ç•Œé¢
# =========================================================================
st.set_page_config(page_title="å¹¿å‘Šé…ç½®ç”Ÿæˆå™¨ (Waterfallç‰ˆ)", layout="wide")
st.title("ğŸŒŠ å¹¿å‘Šé…ç½®è‡ªåŠ¨åŒ–å·¥å…· (Waterfall å®Œæ•´ç‰ˆ)")

# ä¾§è¾¹æ è¯´æ˜
with st.sidebar:
    st.info("å·²åŠ è½½å†…ç½®æ¨¡æ¿ï¼š\n1. ç©¿å±±ç”² (å«å¼€å±/æ’å±/è§†é¢‘)\n2. ä¼˜é‡æ±‡ (å«å¼€å±/æ’å±/è§†é¢‘)\n3. å¿«æ‰‹ (æ’å±/è§†é¢‘/ä¿¡æ¯æµ)")

# 1. é€‰æ‹©æ¸ é“
st.subheader("1. é€‰æ‹©å¹¿å‘Šæ¸ é“")
selected_channels = st.multiselect(
    "è¯·é€‰æ‹©ç›®æ ‡å¹³å°:", 
    options=["ç©¿å±±ç”²", "ä¼˜é‡æ±‡", "å¿«æ‰‹"], 
    default=["ä¼˜é‡æ±‡"]
)

# 2. è¾“å…¥è¡¨æ ¼
st.subheader("2. æ‰¹é‡è¾“å…¥äº§å“ä¿¡æ¯")
if 'input_df' not in st.session_state:
    st.session_state.input_df = pd.DataFrame([{
        "äº§å“åç§°": "ç¤ºä¾‹äº§å“", 
        "äº§å“ID": "12345", 
        "å¹¿å‘ŠID": "67890"
    }])

edited_df = st.data_editor(
    st.session_state.input_df,
    num_rows="dynamic",
    column_config={
        "äº§å“åç§°": st.column_config.TextColumn("äº§å“åç§°", help="æ–°äº§å“çš„ä¸­æ–‡åç§°"),
        "äº§å“ID": st.column_config.TextColumn("äº§å“ID", help="å¯¹åº”å¹³å°çš„åº”ç”¨ID"),
        "å¹¿å‘ŠID": st.column_config.TextColumn("å¹¿å‘ŠID", help="å¯¹åº”å¹³å°çš„å¹¿å‘Šä½ID (tappid)"),
    }
)

# 3. ç”Ÿæˆ
st.markdown("---")
if st.button("ğŸš€ ç«‹å³ç”Ÿæˆé…ç½®æ–‡æ¡£", type="primary"):
    if not selected_channels:
        st.error("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ¸ é“ï¼")
    elif edited_df.empty:
        st.error("è¯·å¡«å†™äº§å“ä¿¡æ¯ï¼")
    else:
        zip_buffer = io.BytesIO()
        file_count = 0
        
        with zipfile.ZipFile(zip_buffer, "w") as zf:
            for idx, row in edited_df.iterrows():
                p_name = row["äº§å“åç§°"]
                p_id = str(row["äº§å“ID"])
                t_id = str(row["å¹¿å‘ŠID"])
                
                if not p_name or not p_id: 
                    continue
                
                for ch in selected_channels:
                    # è°ƒç”¨æ ¸å¿ƒå¤„ç†å‡½æ•°
                    final_df = process_rows(ch, p_name, p_id, t_id)
                    
                    if not final_df.empty:
                        # ç”Ÿæˆ Excel
                        xls_data = create_xls_file(final_df)
                        # æ–‡ä»¶å
                        fname = f"{ch}_{p_name}.xls"
                        zf.writestr(fname, xls_data.getvalue())
                        file_count += 1
        
        if file_count > 0:
            st.success(f"âœ… æˆåŠŸç”Ÿæˆ {file_count} ä¸ªæ–‡ä»¶ï¼")
            st.download_button(
                label="ğŸ“¥ ä¸‹è½½æ‰€æœ‰æ–‡ä»¶ (.zip)",
                data=zip_buffer.getvalue(),
                file_name=f"å¹¿å‘Šé…ç½®_{datetime.now().strftime('%H%M%S')}.zip",
                mime="application/zip"
            )
        else:
            st.warning("æœªç”Ÿæˆä»»ä½•æ–‡ä»¶ï¼Œè¯·æ£€æŸ¥è¾“å…¥æ•°æ®ã€‚")
